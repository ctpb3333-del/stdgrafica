<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Analizador de Gr√°ficas - Versi√≥n Web</title>
<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>

<style>
    body {
        margin: 0;
        font-family: "Segoe UI", Arial, sans-serif;
        background: #121212;
        color: #eaeaea;
        display: flex;
        height: 100vh;
    }

    #grafica {
        width: 65%;
        height: 100%;
        border-right: 3px solid #222;
        background: #181818;
    }

    #panel {
        width: 35%;
        padding: 25px;
        background: #1d1d1d;
    }

    h1 {
        margin-top: 0;
        color: #ffffff;
        font-size: 28px;
        text-align: center;
        letter-spacing: 1px;
    }

    label {
        font-weight: bold;
        color: #cfcfcf;
        margin-top: 10px;
        display: block;
    }

    input {
        width: 95%;
        padding: 10px;
        font-size: 16px;
        margin-bottom: 10px;
        border-radius: 6px;
        border: 1px solid #444;
        background: #2a2a2a;
        color: #efefef;
    }

    .correcto {
        background: #1f441f !important;
        border-color: #3fd93f !important;
        color: #aef7ae !important;
    }

    .incorrecto {
        background: #441f1f !important;
        border-color: #ff5c5c !important;
        color: #ffc2c2 !important;
    }

    button {
        width: 48%;
        padding: 12px;
        margin-top: 10px;
        border: none;
        font-weight: bold;
        border-radius: 6px;
        font-size: 16px;
        cursor: pointer;
    }

    #nueva { background: #8e44ad; color: white; }
    #verificar { background: #e67e22; color: white; }
    #solucion { background: #16a085; color: white; width: 100%; margin-top: 15px; }
    #ayuda { background: #2980b9; color: white; width: 100%; margin-top: 15px; }

    #resultado, #sol_texto {
        margin-top: 20px;
        padding: 15px;
        background: #222;
        border-radius: 8px;
        white-space: pre-wrap;
        font-family: monospace;
        font-size: 15px;
        height: 180px;
        overflow-y: auto;
        border: 1px solid #333;
    }

    #sol_texto { display: none; background: #252525; }

    #teoria {
        margin-top: 15px;
        padding: 15px;
        background: #252525;
        border-radius: 8px;
        display: none;
        border: 1px solid #333;
    }

    #teoria h2 {
        margin-top: 0;
        font-size: 20px;
        color: #7fc9ff;
    }

    .symbol-btn {
        margin-left: 5px;
        padding: 8px 12px;
        background: #444;
        color: white;
        border: 1px solid #666;
        border-radius: 6px;
        cursor: pointer;
        font-size: 18px;
    }

    .input-row { display:flex; align-items:center; }
</style>
</head>

<body>

<div id="grafica"></div>

<div id="panel">
    <h1>Analizador de Gr√°ficas</h1>

    <label>Dominio (Df):</label>
    <div class="input-row">
        <input id="df" placeholder="Ej: (-‚àû,3]">
        <button class="symbol-btn" onclick="insertSymbol('df','‚àû')">‚àû</button>
        <button class="symbol-btn" onclick="insertSymbol('df','-‚àû')">‚àí‚àû</button>
    </div>

    <label>Imagen (If):</label>
    <div class="input-row">
        <input id="if" placeholder="Ej: [0,‚àû)">
        <button class="symbol-btn" onclick="insertSymbol('if','‚àû')">‚àû</button>
        <button class="symbol-btn" onclick="insertSymbol('if','-‚àû')">‚àí‚àû</button>
    </div>

    <label>M√°ximo:</label>
    <div class="input-row">
        <input id="max" placeholder="Ej: x=0,y=4">
        <button class="symbol-btn" onclick="insertSymbol('max','‚àû')">‚àû</button>
        <button class="symbol-btn" onclick="insertSymbol('max','-‚àû')">‚àí‚àû</button>
    </div>

    <label>M√≠nimo:</label>
    <div class="input-row">
        <input id="min" placeholder="Ej: x=1,y=-2">
        <button class="symbol-btn" onclick="insertSymbol('min','‚àû')">‚àû</button>
        <button class="symbol-btn" onclick="insertSymbol('min','-‚àû')">‚àí‚àû</button>
    </div>

    <label>Ordenada al origen (Oo):</label>
    <input id="oo" placeholder="Ej: y=4">

    <button id="nueva">Nueva funci√≥n</button>
    <button id="verificar">Verificar</button>
    <button id="solucion">Mostrar soluci√≥n</button>
    <button id="ayuda">Mostrar teor√≠a</button>

    <div id="resultado"></div>
    <div id="sol_texto"></div>

    <div id="teoria">
        <h2>üìò Teor√≠a esencial</h2>

    <p><b>Dominio (Df):</b> Conjunto de valores de x para los que la funci√≥n est√° definida.</p>

    <p><b>Imagen (If):</b> Conjunto de valores de y que puede tomar la funci√≥n.</p>

    <p><b>Ordenada al origen (Oo):</b> Valor donde la funci√≥n corta el eje Y. Se obtiene evaluando la funci√≥n en x = 0.</p>

    <p><b>Ceros de la funci√≥n (C¬∞):</b> Valores de x donde la funci√≥n vale 0 (donde toca el eje X).</p>

    <p><b>Funci√≥n constante:</b> Cuando todos los valores de y son iguales. No tiene m√°ximo ni m√≠nimo y no var√≠a.</p>

    <p><b>Conjunto de positividad (C+):</b> Conjunto de valores de x donde la funci√≥n es mayor que 0.</p>

    <p><b>Conjunto de negatividad (C‚Äì):</b> Conjunto de valores de x donde la funci√≥n es menor que 0.</p>

    <p><b>M√°ximo:</b> Valor m√°s alto que alcanza la funci√≥n en su dominio.</p>

    <p><b>M√≠nimo:</b> Valor m√°s bajo que alcanza la funci√≥n en su dominio.</p>

    <p><b>Crecimiento:</b> Intervalos donde la funci√≥n sube (la y aumenta cuando aumenta x).</p>

    <p><b>Decrecimiento:</b> Intervalos donde la funci√≥n baja (la y disminuye cuando aumenta x).</p>
</div>
</div>

<script>
function insertSymbol(id, symbol) {
    const campo = document.getElementById(id);
    campo.value += symbol;
    campo.focus();
}

const funciones = [
    {
        nombre: "Par√°bola",
        rango: [-3, 3],
        f: x => -x*x + 4,
        analisis: {
            df: "(-‚àû,‚àû)",
            if: "(-‚àû,4]",
            max: "x=0,y=4",
            min: "No tiene",
            oo: "y=4"
        }
    },

    {
        nombre: "C√∫bica",
        rango: [-3, 3],
        f: x => x**3 - 3*x,
        analisis: {
            df: "(-‚àû,‚àû)",
            if: "(-‚àû,‚àû)",
            max: "x=-1,y=2",
            min: "x=1,y=-2",
            oo: "y=0"
        }
    },

    {
        nombre: "Seno",
        rango: [-6.28, 6.28],
        f: x => 2*Math.sin(x),
        analisis: {
            df: "(-‚àû,‚àû)",
            if: "[-2,2]",
            max: "No tiene",
            min: "No tiene",
            oo: "y=0"
        }
    },

    {
        nombre: "Exponencial",
        rango: [-3, 3],
        f: x => 2**x,
        analisis: {
            df: "(-‚àû,‚àû)",
            if: "(0,‚àû)",
            max: "No tiene",
            min: "No tiene",
            oo: "y=1"
        }
    }
];

let actual = null;
let puntosSolucionIndices = []; 
let solucionVisible = false;

function nuevaFuncion() {
    actual = funciones[Math.floor(Math.random() * funciones.length)];

    let x = [], y = [];
    for (let i = 0; i < 300; i++) {
        let t = actual.rango[0] + i * (actual.rango[1] - actual.rango[0]) / 300;
        x.push(t);
        y.push(actual.f(t));
    }

    Plotly.newPlot("grafica", [{
        x: x,
        y: y,
        mode: "lines",
        line: { width: 3, color: "#74b9ff" },
        name: "Funci√≥n"
    }], {
        title: { text: actual.nombre, font: { color: "white", size: 24 } },
        paper_bgcolor: "#181818",
        plot_bgcolor: "#181818",
        xaxis: { zeroline: true, color: "#ccc" },
        yaxis: { zeroline: true, color: "#ccc" }
    });

    document.getElementById("solucion").innerText = "Mostrar soluci√≥n";
    document.getElementById("sol_texto").style.display = "none";
    solucionVisible = false;
    puntosSolucionIndices = [];

    for (let id of ["df","if","max","min","oo"]) {
        let campo = document.getElementById(id);
        campo.value = "";
        campo.classList.remove("correcto", "incorrecto");
    }

    document.getElementById("resultado").innerText = "";
}

function verificar() {
    let r = actual.analisis;

    const campos = {
        df: "Dominio",
        if: "Imagen",
        max: "M√°ximo",
        min: "M√≠nimo",
        oo: "Ordenada al origen"
    };

    let txt = "";

    for (let key in campos) {
        let input = document.getElementById(key);
        let val = input.value.trim().replace(/ /g, "").toLowerCase();
        let correcto = r[key].replace(/ /g, "").toLowerCase();

        if (!val) {
            txt += `‚ö™ ${campos[key]} vac√≠o.\n\n`;
            continue;
        }

        if (val === correcto) {
            input.classList.add("correcto");
            input.classList.remove("incorrecto");
            txt += `‚úÖ ${campos[key]} correcto.\n\n`;
        } else {
            input.classList.add("incorrecto");
            input.classList.remove("correcto");
            txt += `‚ùå ${campos[key]} (${input.value}) ‚Äî Correcto: ${r[key]}\n\n`;
        }
    }

    document.getElementById("resultado").innerText = txt;
}

function mostrarSolucion() {
    if (!solucionVisible) {
        const sol = actual.analisis;
        puntosSolucionIndices = []; 

     
        const gd = document.getElementById('grafica');
        const before = (gd.data && gd.data.length) ? gd.data.length : 0;

        const trazas = [];

        if (sol.oo && sol.oo.toLowerCase() !== "no tiene") {
            const y = parseFloat(sol.oo.replace("y=","").trim());
            if (!isNaN(y)) {
                trazas.push({
                    x: [0],
                    y: [y],
                    mode: "markers",
                    marker: { size: 12, color: "red" },
                    name: "Ordenada al origen"
                });
            }
        }

        if (sol.max && sol.max.toLowerCase().includes("x=") && sol.max.toLowerCase().includes("y=")) {
            try {
                let tmp = sol.max.replace(/ /g,"").replace("x=","").split(",y=");
                let x = parseFloat(tmp[0]);
                let y = parseFloat(tmp[1]);
                if (!isNaN(x) && !isNaN(y)) {
                    trazas.push({
                        x: [x],
                        y: [y],
                        mode: "markers",
                        marker: { size: 12, color: "blue" },
                        name: "M√°ximo"
                    });
                }
            } catch(e) { /* ignorar si no parsea */ }
        }

        if (sol.min && sol.min.toLowerCase().includes("x=") && sol.min.toLowerCase().includes("y=")) {
            try {
                let tmp = sol.min.replace(/ /g,"").replace("x=","").split(",y=");
                let x = parseFloat(tmp[0]);
                let y = parseFloat(tmp[1]);
                if (!isNaN(x) && !isNaN(y)) {
                    trazas.push({
                        x: [x],
                        y: [y],
                        mode: "markers",
                        marker: { size: 12, color: "green" },
                        name: "M√≠nimo"
                    });
                }
            } catch(e) { /* ignorar si no parsea */ }
        }

        if (trazas.length > 0) {
            Plotly.addTraces('grafica', trazas);
            const after = (gd.data && gd.data.length) ? gd.data.length : 0;
            // √≠ndices a√±adidos = before .. after-1
            for (let i = before; i < after; i++) puntosSolucionIndices.push(i);
        }

        let txt =
`üìå SOLUCI√ìN CORRECTA

Dominio: ${sol.df}
Imagen: ${sol.if}
M√°ximo: ${sol.max}
M√≠nimo: ${sol.min}
Ordenada al origen: ${sol.oo}`;

        document.getElementById("sol_texto").innerText = txt;
        document.getElementById("sol_texto").style.display = "block";

        document.getElementById("solucion").innerText = "Ocultar soluci√≥n";
        solucionVisible = true;

    } else {

        if (puntosSolucionIndices.length > 0) {

            try {
                Plotly.deleteTraces('grafica', puntosSolucionIndices);
            } catch (e) {

                Plotly.newPlot('grafica', [{
                    x: (function(){ 
                        const t = [];
                        for (let i=0;i<300;i++){
                            let a=actual.rango[0] + i*(actual.rango[1]-actual.rango[0])/300;
                            t.push(a);
                        }
                        return t;
                    })(),
                    y: (function(){
                        const t = [];
                        for (let i=0;i<300;i++){
                            let a=actual.rango[0] + i*(actual.rango[1]-actual.rango[0])/300;
                            t.push(actual.f(a));
                        }
                        return t;
                    })(),
                    mode: "lines",
                    line: { width: 3, color: "#74b9ff" },
                    name: "Funci√≥n"
                }], {
                    title: { text: actual.nombre, font: { color: "white", size: 24 } },
                    paper_bgcolor: "#181818",
                    plot_bgcolor: "#181818",
                    xaxis: { zeroline: true, color: "#ccc" },
                    yaxis: { zeroline: true, color: "#ccc" }
                });
            }
        }
        document.getElementById("sol_texto").style.display = "none";
        document.getElementById("solucion").innerText = "Mostrar soluci√≥n";
        solucionVisible = false;
        puntosSolucionIndices = [];
    }
}

document.getElementById("nueva").onclick = nuevaFuncion;
document.getElementById("verificar").onclick = verificar;
document.getElementById("solucion").onclick = mostrarSolucion;

document.getElementById("ayuda").onclick = () => {
    let t = document.getElementById("teoria");
    t.style.display = (t.style.display === "none") ? "block" : "none";
};

nuevaFuncion();
</script>

</body>
</html>
